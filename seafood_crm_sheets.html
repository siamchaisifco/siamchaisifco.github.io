<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á + Google Sheets</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .setup-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-top: 5vh;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            position: relative;
            z-index: 1;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            position: relative;
            z-index: 1;
            opacity: 0.9;
        }

        .setup-form {
            padding: 40px;
        }

        .setup-form h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .setup-steps {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .setup-steps h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .setup-steps ol {
            margin-left: 20px;
        }

        .setup-steps li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
        }

        .nav-tab.active {
            background: white;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .customer-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .customer-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #3498db;
        }

        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 25px;
            color: white;
            font-size: 14px;
            z-index: 1000;
        }

        .sync-status.syncing {
            background: #f39c12;
        }

        .sync-status.synced {
            background: #27ae60;
        }

        .sync-status.error {
            background: #e74c3c;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Setup Screen -->
    <div id="setupScreen" class="setup-container">
        <div class="header">
            <h1>üêü ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets</h1>
            <p>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏Å‡∏±‡∏ö Google Sheets</p>
        </div>
        
        <div class="setup-form">
            <div class="setup-steps">
                <h3>üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets:</h3>
                <ol>
                    <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà</strong>
                        <ul style="margin-top: 5px;">
                            <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://sheets.google.com" target="_blank">sheets.google.com</a></li>
                            <li>‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà</li>
                            <li>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ "CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•"</li>
                        </ul>
                    </li>
                    <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</strong>
                        <ul style="margin-top: 5px;">
                            <li><strong>Sheet 1:</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô "Customers"</li>
                            <li><strong>Sheet 2:</strong> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ä‡∏∑‡πà‡∏≠ "Users"</li>
                        </ul>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡πÉ‡∏ô Sheet "Customers":</strong>
                        <div class="code-block">
A1: ID | B1: Email | C1: CustomerName | D1: Country | E1: Phone | F1: ProductGroup | G1: RawMaterial | H1: InquiryDetails | I1: ConversationNotes | J1: DateAdded | K1: LastContact | L1: AddedBy
                        </div>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡πÉ‡∏ô Sheet "Users":</strong>
                        <div class="code-block">
A1: ID | B1: Username | C1: Password | D1: DisplayName | E1: Role | F1: CreatedDate | G1: LastLogin
                        </div>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Admin ‡πÉ‡∏ô Sheet "Users" ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2:</strong>
                        <div class="code-block">
A2: 1 | B2: adminsifco | C2: adminsifco888 | D2: ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö | E2: admin | F2: 2024-01-01 | G2: -
                        </div>
                    </li>
                    <li><strong>‡πÅ‡∏ä‡∏£‡πå Spreadsheet:</strong>
                        <ul style="margin-top: 5px;">
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Share" ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô</li>
                            <li>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "Anyone with the link" + "Editor"</li>
                            <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="form-group">
                <label for="sheetsUrl">üîó URL ‡∏Ç‡∏≠‡∏á Google Sheets:</label>
                <input type="url" id="sheetsUrl" placeholder="https://docs.google.com/spreadsheets/d/your-sheet-id/edit#gid=0" required>
                <small style="color: #666;">‡∏ß‡∏≤‡∏á URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Google Sheets</small>
            </div>

            <button type="button" class="btn btn-primary" onclick="connectSheets()">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</button>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets...</p>
            </div>

            <div id="status" class="status"></div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header">
            <h1>üêü ‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á</h1>
            <p>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('customers')">üìã ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects</button>
            <button class="nav-tab" onclick="showTab('add')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
            <button class="nav-tab" onclick="showTab('reports')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
            <button class="nav-tab" onclick="showTab('settings')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>

        <div class="content">
            <!-- Tab: Customer List -->
            <div id="customers" class="tab-content active">
                <h2 style="margin-bottom: 25px;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects</h2>
                <button class="btn btn-success" onclick="syncFromSheets()" style="margin-bottom: 20px;">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Google Sheets</button>
                <div id="customerList">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <!-- Tab: Add Customer -->
            <div id="add" class="tab-content">
                <h2 style="margin-bottom: 25px;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospect ‡πÉ‡∏´‡∏°‡πà</h2>
                <form id="customerForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="email">* Email:</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="customerName">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:</label>
                            <input type="text" id="customerName">
                        </div>
                        <div class="form-group">
                            <label for="country">* ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</label>
                            <select id="country" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
                                <option value="‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô">‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</option>
                                <option value="‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ">‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ</option>
                                <option value="‡∏à‡∏µ‡∏ô">‡∏à‡∏µ‡∏ô</option>
                                <option value="‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå">‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå</option>
                                <option value="‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á">‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á</option>
                                <option value="‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢">‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢</option>
                                <option value="‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢">‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢</option>
                                <option value="‡∏ü‡∏¥‡∏•‡∏¥‡∏õ‡∏õ‡∏¥‡∏ô‡∏™‡πå">‡∏ü‡∏¥‡∏•‡∏¥‡∏õ‡∏õ‡∏¥‡∏ô‡∏™‡πå</option>
                                <option value="‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°">‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°</option>
                                <option value="‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤">‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤</option>
                                <option value="‡πÅ‡∏Ñ‡∏ô‡∏≤‡∏î‡∏≤">‡πÅ‡∏Ñ‡∏ô‡∏≤‡∏î‡∏≤</option>
                                <option value="‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢">‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
                            <input type="tel" id="phone">
                        </div>
                        <div class="form-group">
                            <label for="productGroup">* ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à:</label>
                            <select id="productGroup" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                                <option value="‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Shrimp)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Squid)</option>
                                <option value="‡∏õ‡∏π‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏π‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Crab)</option>
                                <option value="‡∏´‡∏≠‡∏¢‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏´‡∏≠‡∏¢‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Shellfish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏•‡∏≤‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Fish)</option>
                                <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡∏ú‡∏™‡∏°">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡∏ú‡∏™‡∏° (Mixed Seafood)</option>
                                <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ (Processed Seafood)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rawMaterial">* ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</label>
                            <select id="rawMaterial" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</option>
                                <option value="‡∏Å‡∏∏‡πâ‡∏á‡∏î‡∏¥‡∏ö">‡∏Å‡∏∏‡πâ‡∏á‡∏î‡∏¥‡∏ö (Fresh Shrimp)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡∏î‡∏¥‡∏ö">‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡∏î‡∏¥‡∏ö (Fresh Squid)</option>
                                <option value="‡∏õ‡∏π‡∏î‡∏¥‡∏ö">‡∏õ‡∏π‡∏î‡∏¥‡∏ö (Fresh Crab)</option>
                                <option value="‡∏´‡∏≠‡∏¢‡∏î‡∏¥‡∏ö">‡∏´‡∏≠‡∏¢‡∏î‡∏¥‡∏ö (Fresh Shellfish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö">‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö (Fresh Fish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏ó‡∏π‡∏ô‡πà‡∏≤">‡∏õ‡∏•‡∏≤‡∏ó‡∏π‡∏ô‡πà‡∏≤ (Tuna)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô">‡∏õ‡∏•‡∏≤‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô (Salmon)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inquiryDetails">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°:</label>
                        <textarea id="inquiryDetails" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°..." rows="4"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="conversationNotes">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤:</label>
                        <textarea id="conversationNotes" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤..." rows="4"></textarea>
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets</button>
                    </div>
                </form>
            </div>

            <!-- Tab: Reports -->
            <div id="reports" class="tab-content">
                <h2 style="margin-bottom: 25px;">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ</h2>
                <button class="btn btn-success" onclick="syncFromSheets()" style="margin-bottom: 20px;">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
                <div id="reportContent">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <!-- Tab: Settings -->
            <div id="settings" class="tab-content">
                <h2 style="margin-bottom: 25px;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
                
                <div class="setup-steps">
                    <h3>üîó ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</h3>
                    <p><strong>URL ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> <span id="currentSheetsUrl">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span></p>
                    <button class="btn btn-primary" onclick="showSetupScreen()">üîß ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Google Sheets</button>
                </div>

                <div class="setup-steps">
                    <h3>üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets</h3>
                    <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÉ‡∏ô Google Sheets ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ</p>
                    <button class="btn btn-success" onclick="openGoogleSheets()">üîó ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets</button>
                </div>

                <div class="setup-steps">
                    <h3>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
                    <ul>
                        <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
                        <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</li>
                        <li>‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ</li>
                        <li>‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏ö Header ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á Google Sheets</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Sync Status -->
    <div id="syncStatus" class="sync-status" style="display: none;"></div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á
        let SHEETS_URL = '';
        let SHEET_ID = '';
        let customers = [];
        let currentUser = { username: 'user', role: 'user' };

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        document.addEventListener('DOMContentLoaded', function() {
            const savedSheetsUrl = localStorage.getItem('sheetsUrl');
            if (savedSheetsUrl) {
                SHEETS_URL = savedSheetsUrl;
                SHEET_ID = extractSheetId(savedSheetsUrl);
                showMainApp();
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets
        async function connectSheets() {
            const sheetsUrl = document.getElementById('sheetsUrl').value;
            
            if (!sheetsUrl) {
                showStatus('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡∏Ç‡∏≠‡∏á Google Sheets', 'error');
                return;
            }

            const sheetId = extractSheetId(sheetsUrl);
            if (!sheetId) {
                showStatus('URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', 'error');
                return;
            }

            showLoading(true);

            try {
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                const testUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Customers`;
                const response = await fetch(testUrl);
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÑ‡∏î‡πâ');
                }

                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                SHEETS_URL = sheetsUrl;
                SHEET_ID = sheetId;
                localStorage.setItem('sheetsUrl', sheetsUrl);

                showStatus('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
                setTimeout(() => {
                    showMainApp();
                }, 2000);

            } catch (error) {
                console.error('Connection error:', error);
                showStatus('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á Sheet ID ‡∏à‡∏≤‡∏Å URL
        function extractSheetId(url) {
            const match = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
            return match ? match[1] : null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Loading
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        function showMainApp() {
            document.getElementById('setupScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('currentSheetsUrl').textContent = SHEETS_URL;
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            syncFromSheets();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Setup
        function showSetupScreen() {
            document.getElementById('setupScreen').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Tab
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'customers' || tabName === 'reports') {
                syncFromSheets();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
        async function syncFromSheets() {
            if (!SHEET_ID) return;

            setSyncStatus('syncing', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');

            try {
                const customersUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=Customers`;
                const response = await fetch(customersUrl);
                const text = await response.text();
                
                // ‡∏•‡∏ö prefix ‡πÅ‡∏•‡∏∞ suffix ‡∏Ç‡∏≠‡∏á Google Sheets JSON response
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                if (jsonData.table && jsonData.table.rows) {
                    customers = jsonData.table.rows.map((row, index) => {
                        const cells = row.c || [];
                        return {
                            id: cells[0]?.v || index + 1,
                            email: cells[1]?.v || '',
                            customerName: cells[2]?.v || '',
                            country: cells[3]?.v || '',
                            phone: cells[4]?.v || '',
                            productGroup: cells[5]?.v || '',
                            rawMaterial: cells[6]?.v || '',
                            inquiryDetails: cells[7]?.v || '',
                            conversationNotes: cells[8]?.v || '',
                            dateAdded: cells[9]?.v || '',
                            lastContact: cells[10]?.v || '',
                            addedBy: cells[11]?.v || ''
                        };
                    }).filter(customer => customer.email); // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ email
                }

                loadCustomerList();
                loadReports();
                setSyncStatus('synced', '‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');

            } catch (error) {
                console.error('Sync error:', error);
                setSyncStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets
        async function addToSheets(