<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á + Google Sheets</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .setup-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-top: 5vh;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            position: relative;
            z-index: 1;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            position: relative;
            z-index: 1;
            opacity: 0.9;
        }

        .setup-form {
            padding: 40px;
        }

        .setup-form h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .setup-steps {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .setup-steps h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .setup-steps ol {
            margin-left: 20px;
        }

        .setup-steps li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
        }

        .nav-tab.active {
            background: white;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .customer-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .customer-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #3498db;
        }

        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 25px;
            color: white;
            font-size: 14px;
            z-index: 1000;
        }

        .sync-status.syncing {
            background: #f39c12;
        }

        .sync-status.synced {
            background: #27ae60;
        }

        .sync-status.error {
            background: #e74c3c;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Setup Screen -->
    <div id="setupScreen" class="setup-container">
        <div class="header">
            <h1>üêü ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets</h1>
            <p>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏Å‡∏±‡∏ö Google Sheets</p>
        </div>
        
        <div class="setup-form">
            <div class="setup-steps">
                <h3>üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets:</h3>
                <ol>
                    <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà</strong>
                        <ul style="margin-top: 5px;">
                            <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://sheets.google.com" target="_blank">sheets.google.com</a></li>
                            <li>‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà</li>
                            <li>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ "CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•"</li>
                        </ul>
                    </li>
                    <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</strong>
                        <ul style="margin-top: 5px;">
                            <li><strong>Sheet 1:</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô "Customers"</li>
                            <li><strong>Sheet 2:</strong> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ä‡∏∑‡πà‡∏≠ "Users"</li>
                        </ul>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡πÉ‡∏ô Sheet "Customers":</strong>
                        <div class="code-block">
A1: ID | B1: Email | C1: CustomerName | D1: Country | E1: Phone | F1: ProductGroup | G1: RawMaterial | H1: InquiryDetails | I1: ConversationNotes | J1: DateAdded | K1: LastContact | L1: AddedBy
                        </div>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡πÉ‡∏ô Sheet "Users":</strong>
                        <div class="code-block">
A1: ID | B1: Username | C1: Password | D1: DisplayName | E1: Role | F1: CreatedDate | G1: LastLogin
                        </div>
                    </li>
                    <li><strong>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Admin ‡πÉ‡∏ô Sheet "Users" ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2:</strong>
                        <div class="code-block">
A2: 1 | B2: adminsifco | C2: adminsifco888 | D2: ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö | E2: admin | F2: 2024-01-01 | G2: -
                        </div>
                    </li>
                    <li><strong>‡πÅ‡∏ä‡∏£‡πå Spreadsheet:</strong>
                        <ul style="margin-top: 5px;">
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Share" ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô</li>
                            <li>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "Anyone with the link" + "Editor"</li>
                            <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="form-group">
                <label for="sheetsUrl">üîó URL ‡∏Ç‡∏≠‡∏á Google Sheets:</label>
                <input type="url" id="sheetsUrl" placeholder="https://docs.google.com/spreadsheets/d/your-sheet-id/edit#gid=0" required>
                <small style="color: #666;">‡∏ß‡∏≤‡∏á URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Google Sheets</small>
            </div>

            <button type="button" class="btn btn-primary" onclick="connectSheets()">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</button>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets...</p>
            </div>

            <div id="status" class="status"></div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header">
            <h1>üêü ‡∏£‡∏∞‡∏ö‡∏ö CRM ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á</h1>
            <p>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('customers')">üìã ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects</button>
            <button class="nav-tab" onclick="showTab('add')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
            <button class="nav-tab" onclick="showTab('reports')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
            <button class="nav-tab" onclick="showTab('users')" id="usersTab" style="display: none;">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</button>
            <button class="nav-tab" onclick="showTab('settings')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>

        <div class="content">
            <!-- Tab: Customer List -->
            <div id="customers" class="tab-content active">
                <h2 style="margin-bottom: 25px;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects</h2>
                <button class="btn btn-success" onclick="syncFromSheets()" style="margin-bottom: 20px;">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Google Sheets</button>
                <div id="customerList">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <!-- Tab: Add Customer -->
            <div id="add" class="tab-content">
                <h2 style="margin-bottom: 25px;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospect ‡πÉ‡∏´‡∏°‡πà</h2>
                <form id="customerForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="email">* Email:</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="customerName">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:</label>
                            <input type="text" id="customerName">
                        </div>
                        <div class="form-group">
                            <label for="country">* ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</label>
                            <select id="country" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
                                <option value="‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô">‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</option>
                                <option value="‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ">‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ</option>
                                <option value="‡∏à‡∏µ‡∏ô">‡∏à‡∏µ‡∏ô</option>
                                <option value="‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå">‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå</option>
                                <option value="‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á">‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á</option>
                                <option value="‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢">‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢</option>
                                <option value="‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢">‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢</option>
                                <option value="‡∏ü‡∏¥‡∏•‡∏¥‡∏õ‡∏õ‡∏¥‡∏ô‡∏™‡πå">‡∏ü‡∏¥‡∏•‡∏¥‡∏õ‡∏õ‡∏¥‡∏ô‡∏™‡πå</option>
                                <option value="‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°">‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°</option>
                                <option value="‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤">‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤</option>
                                <option value="‡πÅ‡∏Ñ‡∏ô‡∏≤‡∏î‡∏≤">‡πÅ‡∏Ñ‡∏ô‡∏≤‡∏î‡∏≤</option>
                                <option value="‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢">‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
                            <input type="tel" id="phone">
                        </div>
                        <div class="form-group">
                            <label for="productGroup">* ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à:</label>
                            <select id="productGroup" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                                <option value="‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Shrimp)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Squid)</option>
                                <option value="‡∏õ‡∏π‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏π‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Crab)</option>
                                <option value="‡∏´‡∏≠‡∏¢‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏´‡∏≠‡∏¢‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Shellfish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á">‡∏õ‡∏•‡∏≤‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (Frozen Fish)</option>
                                <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡∏ú‡∏™‡∏°">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡∏ú‡∏™‡∏° (Mixed Seafood)</option>
                                <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ (Processed Seafood)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rawMaterial">* ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</label>
                            <select id="rawMaterial" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</option>
                                <option value="‡∏Å‡∏∏‡πâ‡∏á‡∏î‡∏¥‡∏ö">‡∏Å‡∏∏‡πâ‡∏á‡∏î‡∏¥‡∏ö (Fresh Shrimp)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡∏î‡∏¥‡∏ö">‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡∏î‡∏¥‡∏ö (Fresh Squid)</option>
                                <option value="‡∏õ‡∏π‡∏î‡∏¥‡∏ö">‡∏õ‡∏π‡∏î‡∏¥‡∏ö (Fresh Crab)</option>
                                <option value="‡∏´‡∏≠‡∏¢‡∏î‡∏¥‡∏ö">‡∏´‡∏≠‡∏¢‡∏î‡∏¥‡∏ö (Fresh Shellfish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö">‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö (Fresh Fish)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡∏ó‡∏π‡∏ô‡πà‡∏≤">‡∏õ‡∏•‡∏≤‡∏ó‡∏π‡∏ô‡πà‡∏≤ (Tuna)</option>
                                <option value="‡∏õ‡∏•‡∏≤‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô">‡∏õ‡∏•‡∏≤‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô (Salmon)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inquiryDetails">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°:</label>
                        <textarea id="inquiryDetails" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°..." rows="4"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="conversationNotes">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤:</label>
                        <textarea id="conversationNotes" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤..." rows="4"></textarea>
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets</button>
                    </div>
                </form>
            </div>

            <!-- Tab: User Management (Admin Only) -->
            <div id="users" class="tab-content">
                <h2 style="margin-bottom: 25px;">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Admin Only)</h2>
                
                <button class="btn btn-success" onclick="syncUsersFromSheets()" style="margin-bottom: 20px;">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>

                <div class="setup-steps">
                    <h3 style="margin-bottom: 15px;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà</h3>
                    <form id="userForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="newUsername">* ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                                <input type="text" id="newUsername" required>
                            </div>
                            <div class="form-group">
                                <label for="newPassword">* ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                                <input type="password" id="newPassword" required>
                            </div>
                            <div class="form-group">
                                <label for="newDisplayName">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á:</label>
                                <input type="text" id="newDisplayName">
                            </div>
                            <div class="form-group">
                                <label for="newRole">* ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó:</label>
                                <select id="newRole" required>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</option>
                                    <option value="admin">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</option>
                                    <option value="user">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-success">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets</button>
                    </form>
                </div>

                <div class="setup-steps">
                    <h3 style="margin-bottom: 15px;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                    <div id="userList">
                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                    </div>
                </div>
            </div>

            <!-- Tab: Reports -->
            <div id="reports" class="tab-content">
                <h2 style="margin-bottom: 25px;">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ</h2>
                <button class="btn btn-success" onclick="syncFromSheets()" style="margin-bottom: 20px;">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
                <div id="reportContent">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <!-- Tab: Settings -->
            <div id="settings" class="tab-content">
                <h2 style="margin-bottom: 25px;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
                
                <div class="setup-steps">
                    <h3>üîó ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</h3>
                    <p><strong>URL ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> <span id="currentSheetsUrl">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span></p>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn btn-primary" onclick="showSetupScreen()">üîß ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Google Sheets</button>
                        <button class="btn btn-secondary" onclick="testConnection()" style="background: #6c757d; color: white;">üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
                        <button class="btn" onclick="resetSystem()" style="background: #e74c3c; color: white;">üóëÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </div>

                <div class="setup-steps">
                    <h3>üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets</h3>
                    <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÉ‡∏ô Google Sheets ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ</p>
                    <button class="btn btn-success" onclick="openGoogleSheets()">üîó ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets</button>
                </div>

                <div class="setup-steps">
                    <h3>‚ÑπÔ∏è ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</h3>
                    <div id="systemStatus">
                        <p>üìä <strong>Google Sheets:</strong> <span id="connectionStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span></p>
                        <p>üë• <strong>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:</strong> <span id="userCount">-</span> ‡∏Ñ‡∏ô</p>
                        <p>üìã <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects:</strong> <span id="customerCount">-</span> ‡∏£‡∏≤‡∏¢</p>
                        <p>üïí <strong>‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> <span id="lastSync">-</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sync Status -->
    <div id="syncStatus" class="sync-status" style="display: none;"></div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á
        let SHEETS_URL = '';
        let SHEET_ID = '';
        let customers = [];
        let users = [];
        let currentUser = { username: 'user', role: 'user' };

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        document.addEventListener('DOMContentLoaded', function() {
            const savedSheetsUrl = localStorage.getItem('sheetsUrl');
            if (savedSheetsUrl) {
                // ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß - ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏•‡∏¢
                SHEETS_URL = savedSheetsUrl;
                SHEET_ID = extractSheetId(savedSheetsUrl);
                showMainApp();
            } else {
                // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ - ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ setup
                showSetupScreen();
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets
        async function connectSheets() {
            const sheetsUrl = document.getElementById('sheetsUrl').value;
            
            if (!sheetsUrl) {
                showStatus('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡∏Ç‡∏≠‡∏á Google Sheets', 'error');
                return;
            }

            const sheetId = extractSheetId(sheetsUrl);
            if (!sheetId) {
                showStatus('URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', 'error');
                return;
            }

            showLoading(true);

            try {
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                const testUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Customers`;
                const response = await fetch(testUrl);
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÑ‡∏î‡πâ');
                }

                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                SHEETS_URL = sheetsUrl;
                SHEET_ID = sheetId;
                localStorage.setItem('sheetsUrl', sheetsUrl);

                showStatus('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
                setTimeout(() => {
                    showMainApp();
                }, 2000);

            } catch (error) {
                console.error('Connection error:', error);
                showStatus('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á Sheet ID ‡∏à‡∏≤‡∏Å URL
        function extractSheetId(url) {
            const match = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
            return match ? match[1] : null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Loading
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        function showMainApp() {
            document.getElementById('setupScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('currentSheetsUrl').textContent = SHEETS_URL;
            
            // ‡πÅ‡∏™‡∏î‡∏á tab ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin
            checkAdminAccess();
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            syncFromSheets();
            syncUsersFromSheets();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå admin
        async function checkAdminAccess() {
            try {
                await syncUsersFromSheets();
                // ‡∏´‡∏≤ admin user
                const adminUser = users.find(u => u.username === 'adminsifco' || u.role === 'admin');
                if (adminUser) {
                    currentUser = adminUser;
                    document.getElementById('usersTab').style.display = 'block';
                }
            } catch (error) {
                console.error('Admin check error:', error);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Setup
        function showSetupScreen() {
            document.getElementById('setupScreen').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Tab
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'customers' || tabName === 'reports') {
                syncFromSheets();
            } else if (tabName === 'users') {
                syncUsersFromSheets();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å Google Sheets
        async function syncUsersFromSheets() {
            if (!SHEET_ID) return;

            setSyncStatus('syncing', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ...');

            try {
                const usersUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=Users`;
                const response = await fetch(usersUrl);
                const text = await response.text();
                
                // ‡∏•‡∏ö prefix ‡πÅ‡∏•‡∏∞ suffix ‡∏Ç‡∏≠‡∏á Google Sheets JSON response
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                if (jsonData.table && jsonData.table.rows) {
                    users = jsonData.table.rows.map((row, index) => {
                        const cells = row.c || [];
                        return {
                            id: cells[0]?.v || index + 1,
                            username: cells[1]?.v || '',
                            password: cells[2]?.v || '',
                            displayName: cells[3]?.v || '',
                            role: cells[4]?.v || '',
                            createdDate: cells[5]?.v || '',
                            lastLogin: cells[6]?.v || ''
                        };
                    }).filter(user => user.username); // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ username
                }

                loadUserList();
                updateSystemStatus();
                setSyncStatus('synced', '‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');

            } catch (error) {
                console.error('User sync error:', error);
                setSyncStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets
        async function addUserToSheets(userData) {
            if (!SHEET_ID) {
                alert('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets');
                return false;
            }

            setSyncStatus('syncing', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ...');

            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets
                const sheetData = [
                    userData.id,
                    userData.username,
                    userData.password,
                    userData.displayName,
                    userData.role,
                    userData.createdDate,
                    userData.lastLogin
                ];

                // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á clipboard
                const textToCopy = sheetData.join('\t'); // Tab-separated values
                
                try {
                    await navigator.clipboard.writeText(textToCopy);
                    alert('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheets (Sheet "Users") ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:\n' + 
                          `ID: ${userData.id}\n` +
                          `Username: ${userData.username}\n` +
                          `Password: ${userData.password}\n` +
                          `‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á: ${userData.displayName}\n` +
                          `‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó: ${userData.role}\n` +
                          `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á: ${userData.createdDate}\n` +
                          `Login ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${userData.lastLogin}`);
                } catch (clipboardError) {
                    const message = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Google Sheets (Sheet "Users"):\n\n` +
                        `ID: ${userData.id}\n` +
                        `Username: ${userData.username}\n` +
                        `Password: ${userData.password}\n` +
                        `‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á: ${userData.displayName}\n` +
                        `‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó: ${userData.role}\n` +
                        `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á: ${userData.createdDate}\n` +
                        `Login ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${userData.lastLogin}`;
                    alert(message);
                }

                // ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Sheet "Users"
                const usersSheetUrl = SHEETS_URL.includes('#gid=') 
                    ? SHEETS_URL.replace(/#gid=\d+/, '#gid=1') 
                    : SHEETS_URL + '#gid=1';
                window.open(usersSheetUrl, '_blank');
                
                setSyncStatus('synced', '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                return true;

            } catch (error) {
                console.error('Add user error:', error);
                setSyncStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ');
                return false;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
        function loadUserList() {
            const userList = document.getElementById('userList');

            if (users.length === 0) {
                userList.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ<br><br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Google Sheets ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà</div>';
                return;
            }

            userList.innerHTML = users.map(user => `
                <div class="customer-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div style="font-weight: 600; color: #2c3e50; font-size: 18px;">${user.username}</div>
                        <div style="background: ${user.role === 'admin' ? 'linear-gradient(135deg, #e74c3c, #c0392b)' : 'linear-gradient(135deg, #3498db, #9b59b6)'}; color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">
                            ${user.role === 'admin' ? '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö' : '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'}
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 15px;">
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á</div>
                            <div style="color: #2c3e50; font-weight: 500;">${user.displayName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</div>
                            <div style="color: #2c3e50; font-weight: 500;">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</div>
                            <div style="color: #2c3e50; font-weight: 500;">${user.createdDate || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                            <div style="color: #2c3e50; font-weight: 500;">${user.lastLogin || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö'}</div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 15px;">
                        <button class="btn btn-primary" onclick="editUser('${user.username}')" style="padding: 8px 15px; font-size: 14px;">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        ${user.username !== 'adminsifco' ? `<button class="btn" onclick="deleteUser('${user.username}')" style="padding: 8px 15px; font-size: 14px; background: #e74c3c; color: white;">üóëÔ∏è ‡∏•‡∏ö</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà
        document.getElementById('userForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const displayName = document.getElementById('newDisplayName').value;
            const role = document.getElementById('newRole').value;
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ username ‡∏ã‡πâ‡∏≥‡πÑ‡∏´‡∏°
            if (users.find(u => u.username === username)) {
                alert('‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                username: username,
                password: password,
                displayName: displayName,
                role: role,
                createdDate: new Date().toLocaleDateString('th-TH'),
                lastLogin: '-'
            };
            
            const success = await addUserToSheets(newUser);
            if (success) {
                document.getElementById('userForm').reset();
                // ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                setTimeout(() => {
                    syncUsersFromSheets();
                }, 3000);
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
        function editUser(username) {
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            const newPassword = prompt('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô):', '');
            if (newPassword === null) return; // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            
            const newDisplayName = prompt('‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡∏°‡πà:', user.displayName);
            if (newDisplayName === null) return; // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            
            const newRole = prompt('‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÉ‡∏´‡∏°‡πà (admin/user):', user.role);
            if (newRole === null) return; // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            
            if (newRole !== 'admin' && newRole !== 'user') {
                alert('‚ùå ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ admin ‡∏´‡∏£‡∏∑‡∏≠ user');
                return;
            }
            
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏Ç‡∏≠‡∏á admin ‡∏´‡∏•‡∏±‡∏Å
            if (user.username === 'adminsifco' && newRole !== 'admin') {
                alert('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏î‡πâ');
                return;
            }
            
            let updateMessage = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${username}" ‡πÉ‡∏ô Google Sheets:\n\n`;
            updateMessage += `‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á: ${newDisplayName}\n`;
            updateMessage += `‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó: ${newRole}\n`;
            if (newPassword.trim() !== '') {
                updateMessage += `‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô: ${newPassword}\n`;
            }
            updateMessage += `\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏´‡∏≤‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï "Users" ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô`;
            
            alert('üìù ' + updateMessage);
            
            // ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Sheet "Users"
            const usersSheetUrl = SHEETS_URL.includes('#gid=') 
                ? SHEETS_URL.replace(/#gid=\d+/, '#gid=1') 
                : SHEETS_URL + '#gid=1';
            window.open(usersSheetUrl, '_blank');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
        function deleteUser(username) {
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö admin ‡∏´‡∏•‡∏±‡∏Å
            if (user.username === 'adminsifco') {
                alert('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏î‡πâ');
                return;
            }
            
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${username}"?\n\n‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Google Sheets ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á`)) {
                alert(`üìù ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${username}" ‡∏à‡∏≤‡∏Å Google Sheets:\n\n` +
                      `1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ä‡∏µ‡∏ï "Users"\n` +
                      `2. ‡∏´‡∏≤‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${username}"\n` +
                      `3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Delete row"\n\n` +
                      `‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì`);
                
                // ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Sheet "Users"
                const usersSheetUrl = SHEETS_URL.includes('#gid=') 
                    ? SHEETS_URL.replace(/#gid=\d+/, '#gid=1') 
                    : SHEETS_URL + '#gid=1';
                window.open(usersSheetUrl, '_blank');
            }
        }
        async function syncFromSheets() {
            if (!SHEET_ID) return;

            setSyncStatus('syncing', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');

            try {
                const customersUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=Customers`;
                const response = await fetch(customersUrl);
                const text = await response.text();
                
                // ‡∏•‡∏ö prefix ‡πÅ‡∏•‡∏∞ suffix ‡∏Ç‡∏≠‡∏á Google Sheets JSON response
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                if (jsonData.table && jsonData.table.rows) {
                    customers = jsonData.table.rows.map((row, index) => {
                        const cells = row.c || [];
                        return {
                            id: cells[0]?.v || index + 1,
                            email: cells[1]?.v || '',
                            customerName: cells[2]?.v || '',
                            country: cells[3]?.v || '',
                            phone: cells[4]?.v || '',
                            productGroup: cells[5]?.v || '',
                            rawMaterial: cells[6]?.v || '',
                            inquiryDetails: cells[7]?.v || '',
                            conversationNotes: cells[8]?.v || '',
                            dateAdded: cells[9]?.v || '',
                            lastContact: cells[10]?.v || '',
                            addedBy: cells[11]?.v || ''
                        };
                    }).filter(customer => customer.email); // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ email
                }

                loadCustomerList();
                loadReports();
                setSyncStatus('synced', '‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');

            } catch (error) {
                console.error('Sync error:', error);
                setSyncStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets
        async function addToSheets(customerData) {
            if (!SHEET_ID) {
                alert('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets');
                return false;
            }

            setSyncStatus('syncing', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');

            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Apps Script Web App (‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô Google Forms ‡∏´‡∏£‡∏∑‡∏≠ direct URL manipulation
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                const sheetData = [
                    customerData.id,
                    customerData.email,
                    customerData.customerName,
                    customerData.country,
                    customerData.phone,
                    customerData.productGroup,
                    customerData.rawMaterial,
                    customerData.inquiryDetails,
                    customerData.conversationNotes,
                    customerData.dateAdded,
                    customerData.lastContact,
                    customerData.addedBy
                ];

                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API Key ‡∏´‡∏£‡∏∑‡∏≠ Google Apps Script
                // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏á
                const message = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Google Sheets:\n\n` +
                    `ID: ${customerData.id}\n` +
                    `Email: ${customerData.email}\n` +
                    `‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${customerData.customerName}\n` +
                    `‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®: ${customerData.country}\n` +
                    `‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${customerData.phone}\n` +
                    `‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${customerData.productGroup}\n` +
                    `‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö: ${customerData.rawMaterial}\n` +
                    `‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${customerData.inquiryDetails}\n` +
                    `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${customerData.conversationNotes}\n` +
                    `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°: ${customerData.dateAdded}\n` +
                    `‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${customerData.lastContact}\n` +
                    `‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢: ${customerData.addedBy}`;

                // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á clipboard
                const textToCopy = sheetData.join('\t'); // Tab-separated values
                
                try {
                    await navigator.clipboard.writeText(textToCopy);
                    alert('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheets ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà\n\n' + 
                          '‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡§ï "‡πÄ‡∏õ‡∏¥‡∏î Google Sheets" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á');
                } catch (clipboardError) {
                    alert(message + '\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Google Sheets');
                }

                // ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets
                window.open(SHEETS_URL, '_blank');
                
                setSyncStatus('synced', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                return true;

            } catch (error) {
                console.error('Add to sheets error:', error);
                setSyncStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
                return false;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
        function setSyncStatus(status, message) {
            const syncStatusDiv = document.getElementById('syncStatus');
            syncStatusDiv.className = `sync-status ${status}`;
            syncStatusDiv.textContent = message;
            syncStatusDiv.style.display = 'block';

            if (status === 'synced' || status === 'error') {
                setTimeout(() => {
                    syncStatusDiv.style.display = 'none';
                }, 3000);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
        document.getElementById('customerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const newCustomer = {
                id: Date.now(),
                email: document.getElementById('email').value,
                customerName: document.getElementById('customerName').value,
                country: document.getElementById('country').value,
                phone: document.getElementById('phone').value,
                productGroup: document.getElementById('productGroup').value,
                rawMaterial: document.getElementById('rawMaterial').value,
                inquiryDetails: document.getElementById('inquiryDetails').value,
                conversationNotes: document.getElementById('conversationNotes').value,
                dateAdded: new Date().toLocaleDateString('th-TH'),
                lastContact: new Date().toLocaleDateString('th-TH'),
                addedBy: currentUser.username
            };

            const success = await addToSheets(newCustomer);
            if (success) {
                document.getElementById('customerForm').reset();
                // ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                setTimeout(() => {
                    syncFromSheets();
                }, 3000);
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
        function loadCustomerList() {
            const customerList = document.getElementById('customerList');

            if (customers.length === 0) {
                customerList.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospect<br><br>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>';
                return;
            }

            customerList.innerHTML = customers.map(customer => `
                <div class="customer-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div style="font-weight: 600; color: #2c3e50; font-size: 18px;">${customer.email}</div>
                        <div style="background: linear-gradient(135deg, #3498db, #9b59b6); color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">${customer.country}</div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 15px;">
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.customerName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.phone || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.productGroup}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.rawMaterial}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.dateAdded}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                            <div style="color: #2c3e50; font-weight: 500;">${customer.lastContact}</div>
                        </div>
                    </div>

                    ${customer.inquiryDetails ? `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #3498db;">
                        <h4 style="color: #2c3e50; margin-bottom: 8px;">üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°:</h4>
                        <p>${customer.inquiryDetails}</p>
                    </div>
                    ` : ''}

                    ${customer.conversationNotes ? `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #3498db;">
                        <h4 style="color: #2c3e50; margin-bottom: 8px;">üí¨ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤:</h4>
                        <p>${customer.conversationNotes}</p>
                    </div>
                    ` : ''}

                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 15px;">
                        <button class="btn btn-success" onclick="contactCustomer('${customer.email}')" style="padding: 8px 15px; font-size: 14px;">üìß ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</button>
                    </div>
                </div>
            `).join('');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
        function loadReports() {
            const reportContent = document.getElementById('reportContent');

            if (customers.length === 0) {
                reportContent.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>';
                return;
            }

            // ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
            const totalCustomers = customers.length;
            
            // ‡∏ô‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
            const countryCount = customers.reduce((acc, customer) => {
                acc[customer.country] = (acc[customer.country] || 0) + 1;
                return acc;
            }, {});

            // ‡∏ô‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            const productCount = customers.reduce((acc, customer) => {
                acc[customer.productGroup] = (acc[customer.productGroup] || 0) + 1;
                return acc;
            }, {});

            // ‡∏ô‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö
            const materialCount = customers.reduce((acc, customer) => {
                acc[customer.rawMaterial] = (acc[customer.rawMaterial] || 0) + 1;
                return acc;
            }, {});

            reportContent.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">${totalCustomers}</div>
                        <div style="opacity: 0.9; font-size: 14px;">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ Prospects ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">${Object.keys(countryCount).length}</div>
                        <div style="opacity: 0.9; font-size: 14px;">‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">${Object.keys(productCount).length}</div>
                        <div style="opacity: 0.9; font-size: 14px;">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 5px;">${Object.keys(materialCount).length}</div>
                        <div style="opacity: 0.9; font-size: 14px;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</div>
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px;">üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        ${Object.entries(materialCount).sort((a, b) => b[1] - a[1]).map(([material, count]) => `
                            <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #27ae60;">
                                <h4>${material}</h4>
                                <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</strong> ${count} ‡∏£‡∏≤‡∏¢</p>
                                <p><strong>‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå:</strong> ${((count / totalCustomers) * 100).toFixed(1)}%</p>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3 style="margin-bottom: 15px;">üåè ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        ${Object.entries(countryCount).sort((a, b) => b[1] - a[1]).map(([country, count]) => `
                            <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #27ae60;">
                                <h4>${country}</h4>
                                <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${count} ‡∏£‡∏≤‡∏¢</p>
                                <p><strong>‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå:</strong> ${((count / totalCustomers) * 100).toFixed(1)}%</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
        function contactCustomer(email) {
            window.open(`mailto:${email}?subject=‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á&body=‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞%0A%0A‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞`, '_blank');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Google Sheets
        function openGoogleSheets() {
            if (SHEETS_URL) {
                window.open(SHEETS_URL, '_blank');
            } else {
                alert('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets');
            }
        }
    </script>
</body>
</html>
